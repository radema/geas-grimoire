# Word-Doc Skill Design

**Date:** 2026-01-18  
**Status:** Approved

## Overview

A skill to create professional Word documents (`.docx`) using company templates. The agent writes narrative content based on user-provided data and context; a Python script handles the conversion from Markdown to styled Word format.

## Core Workflow

1. **Parse Request:** Identify template, scope, and data sources
2. **Extract Palette:** Load colors from `palette.json` if available
3. **Generate Charts:** Produce Seaborn charts as `.png` files
4. **Write Content:** Generate Markdown with YAML frontmatter
5. **Run Converter:** Execute `md_to_docx.py` to produce final `.docx`
6. **Deliver:** Present file path to user

## Skill Structure

```
word-doc/
├── SKILL.md
├── scripts/
│   ├── md_to_docx.py       # Markdown → Word converter
│   └── chart_generator.py  # Seaborn chart wrapper
├── templates/
│   └── default.docx        # Placeholder template
└── references/
    └── markdown_syntax.md  # Supported elements
```

## Markdown Source Format

```markdown
---
template: report.docx
placeholders:
  client_name: "Acme Corp"
  date: "2026-01-18"
---

# Executive Summary

Content generated by agent based on user context...

![Chart](charts/sales_trend.png)
```

## Supported Markdown Elements

| Syntax | Word Mapping |
|--------|-------------|
| `# H1` | Heading 1 style |
| `## H2` | Heading 2 style |
| `**bold**` | Bold run |
| `*italic*` | Italic run |
| `- item` | Bullet list |
| `1. item` | Numbered list |
| `| table |` | Word table |
| `![](path)` | Inline image |
| `{{var}}` | YAML substitution |

## Script Specifications

### md_to_docx.py

**Dependencies:** `python-docx`, `pyyaml`, `mistune`

```bash
python md_to_docx.py \
  --input content.md \
  --template templates/report.docx \
  --output final_report.docx
```

### chart_generator.py

**Dependencies:** `seaborn`, `matplotlib`, `pandas`

```bash
python chart_generator.py \
  --type line \
  --data data.csv \
  --x "month" --y "revenue" \
  --palette "#1a73e8,#34a853" \
  --output chart.png
```

## Error Handling

| Scenario | Behavior |
|----------|----------|
| Template not found | Exit with error |
| Missing placeholder | Warn, leave visible |
| Image not found | Insert placeholder text |
| Parse error | Log, skip block, continue |

## Extensibility

- Add templates: Drop `.docx` + `palette.json` into `templates/`
- Add chart types: Extend `chart_generator.py`
- Custom styles: Configure markdown-to-style mapping
